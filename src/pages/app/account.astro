---
import AppLayout from "@/layouts/AppLayout.astro";
import { AccountView } from "@/components/account/AccountView";
import type { UserAccountDTO } from "@/types";

// User is already authenticated by AppLayout (requireAuth guard)
// AppLayout uses requireAuth which ensures user exists
const authUser = Astro.locals.user;

if (!authUser || !authUser.email) {
  throw new Error("User not authenticated or email missing");
}

// Map Supabase User to UserAccountDTO
const user: UserAccountDTO = {
  id: authUser.id,
  email: authUser.email,
  created_at: authUser.created_at,
};
---

<AppLayout title="Moje konto - 10x Cards">
  <AccountView user={user} client:load />
</AppLayout>
