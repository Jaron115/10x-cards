---
import Layout from "./Layout.astro";
import { Sidebar } from "../components/navigation/Sidebar";
import { requireAuth } from "@/lib/auth/guards";

interface Props {
  title?: string;
}

const { title = "10x Cards" } = Astro.props;

// Require authentication - redirect to login if not authenticated
const user = requireAuth(Astro);

const userEmail = user.email || undefined;
const currentPath = Astro.url.pathname;
---

<Layout title={title}>
  <div class="min-h-screen flex bg-gray-50">
    <!-- Sidebar - hidden on mobile, visible on lg+ -->
    <Sidebar currentPath={currentPath} userEmail={userEmail} client:load />

    <!-- Main content - full width on mobile, with sidebar space on lg+ -->
    <main class="flex-1 overflow-y-auto w-full">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-8">
        <slot />
      </div>
    </main>
  </div>
</Layout>
